using HarmonyLib;using StardewModdingAPI;using StardewValley;using StardewValley.Characters;using MyChildCore.Utilities;using System.Linq;namespace MyChildCore{    public class ModEntry : Mod    {        public static ModEntry Instance { get; private set; }        private Harmony _harmony;        public override void Entry(IModHelper helper)        {            Instance = this;            CustomLogger.Init(Monitor);            // 이벤트 연동            helper.Events.GameLoop.SaveLoaded += (s, e) => ApplyCustomChildAppearance();            helper.Events.GameLoop.DayStarted += (s, e) => ApplyCustomChildAppearance();            // 하모니 패치 예시 (Child.reloadSprite 패치)            _harmony = new Harmony(ModManifest.UniqueID);            _harmony.Patch(                original: AccessTools.Method(typeof(Child), nameof(Child.reloadSprite)),                postfix: new HarmonyMethod(typeof(ModEntry), nameof(AfterChildSpriteUpdate))            );            CustomLogger.Info("[MyChildCore] 모드 초기화/이벤트/패치 완료!");        }        private void ApplyCustomChildAppearance()        {            // 예시: 플레이어의 첫 번째 자녀의 외형을 자동 적용            var myChild = Game1.player.getChildren().ToList().FirstOrDefault();            if (myChild == null)            {                CustomLogger.Warn("내 자녀가 없습니다.");                return;            }            // 예시: spouseName으로 폴더 구분, png 자동 적용 (assets/children/<배우자>/baby.png)            string spouse = Game1.player.spouse;            string assetPath = $"assets/children/{spouse}/baby.png";            try            {                myChild.Sprite.LoadTexture(assetPath); // **Texture 직접 할당 X, 반드시 LoadTexture(경로)**                CustomLogger.Info($"자녀({myChild.Name}) 외형을 {assetPath}로 적용 완료.");            }            catch (System.Exception ex)            {                CustomLogger.Warn($"자녀 외형 적용 실패: {assetPath}, 예외: {ex.Message}");            }        }        public static void AfterChildSpriteUpdate(Child __instance)        {            var myChild = Game1.player.getChildren().ToList().FirstOrDefault();            if (__instance.Name == myChild?.Name && __instance.idOfParent.Value == myChild?.idOfParent.Value)            {                // 다시 한번 폴더 자동 적용                string spouse = Game1.player.spouse;                string assetPath = $"assets/children/{spouse}/baby.png";                try                {                    __instance.Sprite.LoadTexture(assetPath);                }                catch { }            }        }    }}